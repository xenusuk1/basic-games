#lang "qb"
'Your Computer Jan 1982 p30
'https://archive.org/details/your-computer-magazine-1982-01/page/n30/mode/1up?view=theater

0 REM *****
1 REM **
2 REM **
3 REM **
4 REM **
5 REM **
6 REM ** TREASURE HOUSE by C.J.DAVISON in XTAL 2.2 BASIC
7 REM *********
8 CLS
9 GOSUB 8000
10 REM HOUSE MK I
REM M() house vars, T() Treasure vars, D$ descs, MM$ monsters, A() B() clue locs
20 DIM M(7,7,3),T(7,7,3),D$(12), MM$(30), A(4),B(4)
30 RESTORE
40 GOSUB 1000
50 GOSUB 1300
55 PRINT "BHIT ANY KEY TO PLAY":J=INCH
56 TI="000000"
60 CLS

70 GOSUB 1400
80 GOSUB 1600
90 IF INT(1+6*RND (8)>=4 THEN GOSUB 4000
100 IF ST<1 THEN GOSUB 6000
110 IF Z=0 AND X-XX AND Y=YY THEN GOSUB 5000
200 GOTO 70

1000 REM SET UP HOUSE DETAILS
1010 FOR B-1 TO 3:FOR A=1 TO 6
1020 MCA,3,B)=1:M<3,A,B)=1
1030 NEXT A,B
1040 A INT(1+6*RND<7>>
1850 FOR B-1 TO 3:MCA,3,B)=4: NEXT B
1860 DATA 2,2,1,1,2,3,4,1.5,2,6,2,3,1,4,2.5,2,6,1,4,5,4,6,5,4,6,4,9 
1070 FOR F-1 TO 3:RESTORE
1080 READ A: IF A 9 THEN 1120
1090 B-INT(1+A*RND<9>>
1100 FOR C=1 TO BREAD D.E:NEXT C:M(D,E,F)=INT(2+2+RND(5>>
1110 IF BEA THEN 1080 ELSE READ D,E:B-B+1:GOTO 1110
1120 NEXT F
1130 FOR C=0 TO 3:FOR A=1 TO 6: FOR B=1 TO 6
1140 IF MCB, A, C><>0 THEN 1180
1150 MCB,A,C)=INT (5+8+RND (3))
1180 NEXT B,A,C
1190 FOR D=1 TO 2
1200 A-INT(1+6*RND(7)>
1218 B=INT(1+6*RND (7)>
1220 C=INT(1+3*RND<5>>
1230 IF MCA,B,C)<5 OR MCA,B,C>>8 THEN 1200
1240 IF D=1 THEN T(A, B, 1)=5
1242 IF D 2 THEN T(A, B, C)=7
1245 NEXT D
1250 RETURN

1300 REM OTHER BITS
1310 K=0:X-3: Y=6:2=1: L=0: TF=0
1320 DATA HALL, DOOR, DOOR, STAIRCASE, DESK, CUPBOARD
1330 DATA CLOCK, PIANO, CHAIR, STATUE, FIREPLACE, BOOKCASE
1340 FOR A=1 TO 12: READ D$(A): NEXT A
1350 MO=0: ST-100: CLS=STRS(INTC1080+8999+RND(7)>>=CC=1
1360 FOR A=1 TO 6: FOR B=1 TO 6
1370 MCA, B, 0)=INT (5+8+RND (8)>
1380 NEXT B, A
1381 DATA TROLL, GHOST, IMP, BAT GIANT ZOMBIE, GROCKLE, HOUND, DEVIL, KOBOLD, RAT, XORN 
1382 DATA GOBLIN, ORCUS, HYDRA, SERPENT, BASILISK, PHEONIX, MEDUSA, SALAMANDER
1383 DATA GARGOYLE, BEHOLDER, JUBILEX, GOLEM, VAMPIRE, HELL HOUND, GUARDIAN, ORC, ELF 
1384 FOR T=1 TO 29: READMMS(T): NEXT
1385 XX=INT (1+6+RND (8)):YY=INT (1+7*RND(7)>
1386 FOR A=1 TO 6: FOR B=1 TO 6: FOR C=8 TO 3: IF T(A,B,C><>0 THEN 1388
1387 F INT(1+7*RND (7))=5 THEN T(A,B,C)=8
1388 IF INT(1+4 RND (7)>=2 AND T(A,B,C)=0 THEN T(A,B,C)=INT (1+4 RND (8>> 
1389 NEXT C.B.A
1390 FOR A=1 TO 4
1391 B-INT(1+6*RND (8)>:C=INT (1+6 RND (9)):D=INT (1+3*RND<6>>
1392 IF T(B,C,D)<>0 OR MCB,C,D)<5 OR MCB.C.D>>8 THEN 1391
1393 T(B,C,D)=6
1394 NEXT A
1396 RETURN

1400 REM OPTIONS
1401 PRINT

1410 M=MCX, Y-1,Z): A$="North"
1420 GOSUB 1500
1430 M=MCX-1,Y,Z): A$="West"
1440 GOSUB 1500
1450 M=M(X+1,Y,Z): A$="East"
1460 GOSUB 1500
1462 M=M(X, Y, Z): A$="By the side " 1464 GOSUB 1500


1466 MMCX, V+1.2) 10"South"
1468 GOSUB 1500
1478 RETURN

1500 REM DESCRIPTIONS
1510 IF (CMCX.v.2)=1 OR MCX.V.24)AND M>4) OR HO THEN RETURN
1515 IF (MCX.v.2)4 OR MOX.V.2) 3) AND (MS AND HS) THEN RETURN 1516 IF MCX.v.2) 2 AND 14 THEN RETURN
1520 PRINT AS of you is "DR(HD)
1538 RETURN

1600 REM YOUR CHOICE
1610 PRINT "(1)nove (2)exelore (3)open (4)status" 
1625 PRINT
1630 A=INCH-48:IF A<1 OR A>3 THEN GOSUB 4200:GOTO 1600 
1640 ON A GOSUB 1700.1900.2000
1650 RETURN

1700 REM MOVE
1710 PRINT (1)north (2)south (3)uest (4)east" 
1730 INCH-481 IF A1 OR A4 THEN 1730
1740 IF R1 THEN C-11-0
1750 IF A 2 THEN C+18=0
1760 IF A THEN C18-1 1770 IF A4 THEN C18+] 1780 MMCX B.V.C.Z
1781 IF M-8 THEN RETURN
1785 IF MCX. V.2)=3 THEN GOSUB 2700:GOTO 1800
1786 IF MCX.v.2)-2THEN GOSUB 27001 IF M4 THEN RETURN
1790 IF (CMCX.v.2) 1 OR MCX.V.2)4) AND M:4) OR MAD THEN RETURN
1791 IF (MOV.234 OR MOX.V.2)-3) AND (MCS AND M>> THEN RETURN 1792 IF MCX.V.2) 2 AND 14 THEN RETURN
1800 X X BIVV.C
1810 RETURN

1900 REM EXPLORE
1910 IF MCX.V.2-4 THEN GOSUB 2100: GOTO 1930
1928 ON TCX.V.Z
1930 RETURN

2000 REM OPEN
GOSUB 2288.2388. 2400-2500, 2600-1250.1250.5100

2010 ON MCX.V.Z) GOSUB 1930.2700-2708-1930-2900-3000-3100-3200 
2020 IF MCX. V.2>>1 AND MCXV.2><9 AND MOX.V.204 THEN 2050
2030 PRINT "I've never opened a "DBMX.V.2))
2040 PRINT "and i don't intend to start nou!"
2050 RETURN

2100 REM STAIRS
2120 PRINT ""

2110 PRINT "Clinb up or down?"
2120 PRINT "1 or 2"
2130 A-INCH-481 IF AC1 OR A2 THEN 2130
2140 IF (A-1 AND 2-3)OR(A-2 AND 2-1) THEN PRINT "you can't": GOTO 2130 
2150 IF A 1 THEN 2+2+11ELSE 2-2-1
2160 RETURN
 
2200 REM TRAP
2210 PRINT "CONGATULATIONS. You've just found a trap"
2220 A-INT(20+30+RND(7)):PRINT "As of you strength units are used u" 
2230 ST-ST-A
2240 PRINT "You are lucky, you are still alive but only Just!"
2250 PRINT "Tread nore carefully in future...."
2260 RETURN

2300 REM KEY

2310 PRINT "You have just found a key.however it may well be boobytroeped!" 
2320 PRINT "Do you want it?" INCH
2330 IF A<>89 THEN PRINT "NO..ck suit yourself" :RETURN
2340 IF INTC1+9 RND(7)<3 THEN PRINT "The key's yours " IK 11TXV.2>-01RETURN 
2350 PRINT
2360 PRINT "BOOBYTRAPPED!"

2370 GOSUB 2220
2300 RETURN

2400 REM  LAMP

2410 PRINT "Ah ha.one lane yours for the sakens"
2420 PRINT "Do you want it?" INCH
2430 IF AC89 THEN PRINT "NO!"RETURN
2440 IF INTC1+9+RND (8)))? THEN L1 PRINT "The lone is yours" : T(XV, 2-0 : RETURN
2450 PRINT "Oh dear this lone wasn't for sale! You've to trouble...." 
2460 GOSUB 2500 : RETURN

2500 REM TRIGGER
2505 IF MOI THEN RETURN

2510 PRINT "WELL DONE.......IDIOT"
2520 PRINT "you've just disturbed all the orrible little burs!!!"
2530 PRINT "Belive ne your in for fun nou!"
2540 RETURN

2600 REM CELLAR ENTRANCE
2605 IF 201 THEN RETURN
2618 PRINT "Well well well look what you've found"
2611 PRINT "Ves the cellar entrance"
2615 PRINT "DO YOU WANT TO GO IN"A-INCH
2620 IF AC89 THEN PRINT OK RETURN
2630 IF L THEN PRINT "Toush you'll need a lane!"RETURN
2640 2-01PRINT "Good luck "GOSUB 2538
2650 RETURN

2700 REM DOOR
2710 IF MCX.V.2)-3 THEN PRINT "ok the door is open":RETURN
2720 PRINT "the door is locked"
2738 IF K<> THEN PRINT "you will need a key to open it "RETURN
2740 PRINT "do you wish to unlock" 17INCH
2758 IF A<89 THEN PRINT "suit yourself!"RETURN
2760 MX.V.2)=3: PRINT "the door is een"
2770 IF INTC1+9+RND<7>>3 THEN PRINT "the key is Jahned in the lock "IKO 
2700 RETURN

2900 REM DESK
2910 IF INTC1+5+RND(8)><2 THEN 2950
2920 PRINT The desk is Janned, do you wish to force it?A-INCH 
2930 IF AC89 THEN RETURN
2940 ST-ST-INTC1+10 RND (8))1PRINT "UGGGGH. opened it!"
2950 IF TCX.V.230 THEN PRINT "waste of tine.it's empty":RETURN 
2960 CN TCX.V.2) GOSUB 1250.2300-2400-2500-2600, 3400-3500 
2970 RETURN

3000 REM CUPBOARD
3010 IF L-0 THEN PRINT "It's too dark to see you need a lane" : RETURN 
3020 IF INTC1+9 RND (2) THEN PRINT "Your lanes bloun out!"
3030 GOSUB 2950
3040 RETURN

3100 REM CLOCK
3120 ST-ST-INT(1-5 RND (9)
1110 PRINT "Creeeeeeek the door is stiff and this weakens you"
3130 IF INTC1-9 RND (0) 4 THEN GOSUB 4000
3140 GOSUB 2950
3150 RETURN

3200 REM PIANO
3210 PRINT "Consratulations. You have found a KEY"
3220 IF TCX.V.22 THEN PRINT "But then esain nost pianos have keys!!!" 
3230 GOSUB 2950
3240 RETURN

3300 REM END
3305 PRINT
3310 PRINT "HA HA... THE HOUSE HAS CLAIMED ANOTHER BODY!!!"
3320 PRINT "THE TREASURE LIES HIDDEN. YOU HAVE FAILED"
3330 PRINT "YOUR FINAL STATUS IS..."
3340 G0SUB 4220
3350 GOTO 4309

3400 REM CLUE
3410 PRINT "VOU HAVE FOUND A CLUE..."
3420 CC CC 11 IF CC-5 THEN PRINT "THE LAST ONE YOU'LL NEED"
3430 PRINT "THE NUMBER IS...." : MID# CLS-CC-11 "REMEMBER IT." 
3440 TCX.V.2)-0
3450 RETURN

3500 REM COMBLOCK
3520 PRINT "ARE YOU READY TO TRY"
3510 PRINT "VOU HAVE FOUND THE PLACE TO DEPOSIT YOUR CLUES"
3530 IF AC89 THEN RETURN
INCH
3540 PRINT "ENTER THE CODE AND AFTER CHECKING PRESS (CR)"
3550 INPUT CHEI CHECHE
3560 IF CHESICLE THEN PRINT "WRONG.... YOU HAVE FAILED..NOW DIE"  : GOTO 3300

3570 PRINT "BERILLIANT VOU HAVE DONE WELL MY FRIEND" 
3580 T=1
3581 GOSUB 7000
3585 GOSUB 4200 
3586 GOTO 4309 


4000 REM MONSTERS
4010 IF 0 0 THEN RETURN

4020 INT 1 29 R(8)>10A INT 14+RNO (8) 
4020 FRINT "you have just been confronted be "
4040 FRINT (A) PRINT "Buhet do you wish to go "
4050 PRINT "(1) Retreat 12) Attack (3) Gamble" 
4060 CINCH-481 IF CC1 OR C THEN 4050
4070 ON C GOTO 4000.4120.4160
4080 IF INT(1-3 RND (8)2 THEN PRINT "Escored":RETURN
4090 PRINT "A does not iske chickens"
4100 PRINT "he attacks.ood luck"
4120 PRINT "The ",MM(A), "has 18that con"
4125 PRINT "Buhes's your punch rector" UINCH-4812F US OR U THEN 4125 
4126 PRINT
4130 ST ST-U
4135 UU+INT(1-5718=-U
4140 PRINT "Vour punch leaves the "on"
4145 PRINT "strength unsta"
4150 CHINTC110<B>>
4152 6-8-CIF DI THEN ST-ST-BI PRINT "You
"RETURN
4154 ST-ST-C+21PRINT "his hit leaves you with "Stunts" 
4156 IF STCL THEN RETURN IELSE 4125
4160 INTC1+20+RND<6)>1 PRINT AT HT counts are of stake"
4170 PRINT "Choose a number between 1 and 1" -INPUT E
4180 IF E=INT(1+(20-A)+RND(8) THEN STEST-AI PRINT "YOU MIN..." : RETURN 
4190 PRINT "HA HA VOU LOSE" : ST-ST-A
4195 RETURN

4200 REM STATUS
4210 PRINT "VOUR CURRENT STATUS 15..."
4215 PRINT
4220 PRINT "STRENGTH.." ,ST
4250 PRINT "MONSTERS KILLED.",MK
4235 PRINT "TREASURE..",TR
4240 PRINT "KEY.", K
4250 PRINT "LAMP".L
4260 PRINT "CLUES.",  CC-1
4270 PRINT "LEVEL.", Z
4280 PRINT "COORDINATES."X,Y
4290 PRINT "TIME.." , LEFTECTIE 21HIDE(T32) TRIGHTECTS 2)

4300 SC=MK 100+TR+10 (KL)+10+ST-UAL (LEFT(T18.4))
4301 IF CC=5 THEN SC=SC*2 
4302 IF TF-1 THEN SC-SC-2
4303 PRINT  "YOUR SCORE IS***", SC
4305 RETURN

4309 PRINT "DO YOU WANT ANOTHER GO?"
4310 INCH: IF A=89 THEN RUN
4320 CLS
4330 END

5000 REH KIDNAPPED
5010 PRINT "oooooooooosh you've just found a travel asent!"
5020 PRINT "And you have been kidnereed and released somewhere but where?" 5030 XINT(1+6+D(8)
5040 VINT(1+6+RND())
5050 2-INT(1-3 RND(7))
5060 RETURN

5100 REM TREASURE
5110 A INTC1 900+RND(9)
5120 PRINT "You have found"1 As "eseces of Fold"
5130 PRINT "Do you want then?"-INCH
5140 IF B89 THEN RETURN
5150 TR-TR-AIST-ST-INTCA-48)
5155 TOGV.2)=0
5160 IF INT(1+9+RND<B>>>2 THEN RETURN
$165 PRINT "You have also found!"
5170 AINT(1+9+RND(8))
5180 IF A=1 THEN PRINT "a sword" :ST-ST+INT(1+20+RNO-<7>>
5190 IF A=2 THEN PRINT "bod luck!" : IMO-1
$200 IF A=3 THEN PRINT " Potion": ST-ST INT (1+20+RN)-5 
5210 IF A=4 THEN PRINT "an axe" : 1ST ST+7
5220 IF A=5 THEN PRINT "a lone" : L
5230 IF A=6 THEN PRINT "a key"
5240 IF A=7 THEN PRINT "a tine ware" : TI"000000"
5258 IF A=8 THEN PRINT " nuset" : TR=TR+INT <1+800+(8)
5260 IF A=9 THEN PRINT "a rood luck charm" : MO-ST-ST-10
5270 GOTO 5160

6000 REM STRENGTH
6001 IF TR<38 THEN GOTO 3300
6002 PRINT "0000"
6010 PRINT " you seen to be out of energy"
6015 PRINT "o srand score of ISTI"you need help!"
6016 PRINT "Since you have "TRI"itens of treasure"
6017 PRINT "I feel i do a deal with you"
6020 A-INT(9+20+RND(8) INT (TRA)
6030 PRINT "I'll sell you one unit of energy for"
6040 PRINT "Pieces of treasure you give ne...OK"-INCH
6050 IF B-89 THEN ST-ST INT (TR/ADTR TR-A INT(TR/A RETURN
6060 IF INTC1+4+RND (0))-3 THEN PRINT FOOLI GOTO 33001 ELSE 6020 

7000 REM BOOBYTRAP
7010 PRINT "The previous owner of the treasure nade" 
7020 PRINT "sure that his secret would remain hidden" 
7030 PRINT for a long time he also rove the finder" 
7040 PRINT "one final test. if you win..the treasure" 
7050 PRINT "is yours...if you lose DEATH"
7060 PRINT "do you want to take the chance"INCH
7070 IF AC89 THEN PRINT "OK..YOU HAVE DONE WELL" RETURN 7000 PRINT "GOOD LUCK"
7090 PRINT "The chest hos e lock on 41"
7100 PRINT "To open it you must creck the code HIT <CR> TO CONTINUE" IA-INCH 
7110 FOR 1 TO 41RINT(19+RND(8)>NEXT X
LO IRETURN
7120 FOR 1T041 FORY 1 TO 41 IF XV THEN 7130 
7125 IF AC ACV) THEN U1


7130 NEXT V.X: IF U THEN UGOTO 7110
7140 PRINT "moint will be sive if you choose right number in right place."
7150 PRINT "1 point for risht number urons place"
7155 0
7160 PRINT "Bok type in your suess"
7170 FOR X1 TO 4:BOX-INCH-481 NEXT X
7180 FOR 1 TO 4: IF BOO-AX) THEN S=S+3 
7182 NEXT X
7190 FOR 1 TO 41FOR V1 TO 4
7200 IF THEN 7220
7210 IF BY ROD THEN SS+1:CALL 62
7220 NEXT V.X
7230 FOR X-1 TO 41 PRINT B00 NEXT
7240 PRINT
7250 IF 5-12 THEN PRINT "ALL DONE " :TR TRINT (999999999 AND (8))RETURN 
7260 IF INTC110 RND()>4 THEN PRINT "TIMES UP" : 100TO 500
7270 S=0 : GOTO 7170

8000 REM INSTRUCTIONS 
8001 PRINT ""
8002 PRINT"TREASURE HOUSE"
8003 PRINT "0"
8010 PRINT "Vou are in a larse old house"
8020 PRINT "When the old nan who lived there died" 
8030 PRINT "he hid ell his worldly soods in the"
8040 FRINT "house. He also had a hoord of treasure valued at £21)"
8050 PRINT" To find this treasure you must find various clues and.nore" 
8060 PRINT "portantly, the place to eut then..." 
8070 PRINT "BE WARNED, he also left trees for the uwory so 10 carefully"
8080 PRINT "also things may not always be as the seen.GO CAREFULLY MY FRIEND AND GOOD LUCK "
8100 RETURN
8200 REM ***********THE-END*********
